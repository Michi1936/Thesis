\documentclass[]{jsarticle}
\usepackage{float}
\usepackage{bm}
\usepackage{amsmath}
\bmdefine{\bex}{x}
\bmdefine{\vex}{v}
\usepackage[dvipdfmx]{graphicx}
\usepackage{subcaption}

\begin{document}
\title{水面に剛体が衝突した際に生じる気泡の解析}
\author{京都大学理学研究科　物理学宇宙物理学専攻\\流体物理学研究室\\佐藤道矩}
\maketitle
\newpage

\tableofcontents
\newpage
\section{イントロダクション}
\subsection{界面の変形}
水面に水滴あるいは剛体を衝突させた際の現象、即ち水面の変形や気泡の生成は身近な物理現象の一つであり、古くから研究が行われてきた。

水面の変形に関する研究では、Worthingtonによるもの \cite{Worthington1908}がその嚆矢として挙げられることが多い。彼は水面に水滴を衝突させる実験を複数回行い、その度に少しずつ異なるタイミングでストロボを焚いて写真を撮影することで、水飛沫の生成の連続写真を作成することに成功した。以来、撮影器具の進歩に合わせ、より鮮明な画像が撮影され続けてきた。……。

水面に水滴や剛体を衝突させた際に界面が変形し、空気が水中に取り込まれることで気泡（cavity）が生成される現象が確認されている。生成される気泡の大きさは様々であり、剛体球に空気が引きずられるようなもの\cite{Worthington1908}\cite{Mallock1918}、水面の変形によって空気がちぎり取られるようなもの\cite{Oguz1990}などが一例である。

空気が取り込まれる現象は音生成の原因となっている。Minnaert\cite{minnaert1933xvi}が”小川のせせらぎ、瀑布の轟音、海の潮騒についてほとんど分かっていない”と述べたこの現象は、Franz\cite{Franz1959}やPumphrey\cite{Pumphrey1990}らによって研究され、Leightonによる浩瀚な研究書\it{The Acoustic Bubble}\cite{leightonacoustic}にまとめられた。近年では、ハイスピードカメラを用いて、取り込まれた泡が実際に振動している様子が撮影されている\cite{Phillips2018}。

\subsection{SPH法}
流体を粒子の集合として計算する手法は粒子法と呼ばれ、\rm{Smoothed Particle Hydrodynamics}（略称SPH）法は粒子法のモデルの一つである。

SPH法は1977年に、宇宙物理における気体運動の問題を解くための手法として、MonaghanとGingold\cite{Gingold1977}のペア及びLucy\cite{Lucy1977}が別々に発表した。1980年代には宇宙物理に加えて、電磁流体力学や弾性・破壊過程の計算に用いられるようになったが、非圧縮性流体に適応されるようになったのは1990年代の半ばになってからである。1994年にMonaghan\cite{Monaghan1994}が発表した手法が現在流体計算に用いられているモデルの基本となり、以来計算の目的に応じて様々な改良が施され続けている。

流体の複雑な変形を容易に取り扱うことができることから、CG分野でもしばしば用いられており、、、

粒子法は流体を物理量を持った粒子の集合として計算する手法であり、計算領域を格子に分割して計算する手法との差を強調してmesh-freeな方法と呼ばれることもある。利点としては、粒子の運動がそのまま流体の運動になるため、流体の分離や合体といった複雑な変形を容易に扱うことができる。

他の利点としては、プログラムの記述が容易であること、圧力計算の際に状態方程式を用いることで計算時間を大きく削減できることなどが挙げられる。
欠点としては、計算の解像度が粒子数に依存するため運動を詳細に解析するためには大量の粒子が必要となり計算時間が増大すること、激しい流れを扱う計算では高周波振動(High-Frequency Oscillatory, HFO)が観測されることなどが挙げられる。こうした欠点を解決するためのモデルも開発されているが、それらがどこまで物理的に妥当なものであるかは各々に議論が必要となる。

\subsection{先行研究}
剛体球を水面に落とした際の変形に関する研究は、上で述べた通り古くから多数が行われている。近年では、剛体球表面の性質を変えたり、水面突入時の剛体に回転運動を与えるなど、様々なヴァリエーションが存在している。

Duez\cite{Duez2007}らによる研究は、親水性あるいは疎水性の剛体球を水面に衝突させ、気泡が取り込まれる衝突速度のしきい値を実験から導いた。また彼らは、剛体速度と濡れの関係に関するEggers\cite{Eggers2004}の議論を基に、衝突速度のしきい値についての理論式を導出している。剛体速度と濡れの関係の議論はLandau\cite{landau1942}らによるものまで遡る。

SPH法における表面張力のモデルは複数考案されている。

一つはContinuum Surface Force (CSF)モデルと呼ばれるもので、カラー関数あるいは粒子の配置から流体界面の曲率や法線ベクトルを求め、その値に基づき表面張力を計算する。SPH法にはMorris\cite{Morris2000}によって導入された。

一つは、表面張力は微視的には分子間力に依るものであるため、粒子間にも相互作用力を導入し表面張力を再現するモデルである。この手法では流体粒子と個体粒子の間での相互作用力を変化させることで、個体の濡れ性を容易に表現することができる。Akinci\cite{Akinci2013}は流体粒子間の相互作用力を加え、表面積を最小にする計算を行うことで、表面張力を表現した。また個体粒子と流体粒子の間にも相互作用力を加え、個体の濡れ性をある程度制御している。



\newpage
\section{SPH法}
\subsection{SPH法の支配方程式}
\subsubsection{Kernel関数による補間}
座標$\bm{x}$の粒子がもつ物理量Aは次のように表現される、\cite{Becker2007}
\begin{equation}　　
  \label{eqn:SPH_int}
A(\bex)=\sum_b \frac{A_b}{\rho_b} W(\bex-\bex_b,h).
\end{equation}
ここで$A_b=A(\bex_b)$である。WはKernel関数と呼ばれるもので、本計算では次の関数を用いた、
\begin{equation}
  q=\frac{|\bex-\bex_b|}{h}, 
  W(\bex-\bex_b,h)=\begin{cases}
    \frac{15}{14\pi h^2} \left\{(2-q)^3-4(1-q)^3 \right\} & \text{$ 0 \leq q \leq 1$,}\\
    \frac{15}{14\pi h^2} (2-q)^3 & \text{$1\leq q \leq 2$,} \\
    0 & \text{otherwise.}
\end{cases}
\end{equation}
式(\ref{eqn:SPH_int})は、ある位置$\bex$に関して、$\bex$周囲に存在する粒子の物理量Aとその粒子までの距離に応じて減衰するKernel関数を掛けあわせた量を足し合わせることで、$\bex$における物理量Aを求めるものである。

式(\ref{eqn:SPH_int})はKernel関数が微分可能である場合、両辺を微分することが可能であり、次のように表される、
\begin{equation}
\frac{\partial A}{\partial x}=\sum_bm_b\frac{A_b}{\rho_b}\frac{\partial W}{\partial x}.
\end{equation}

例として密度を計算するには、式(\ref{eqn:SPH_int})の$A_b$を$\rho_b$とすればよく、次のように表される、
\begin{equation}
\rho_{a}=\sum_bm_bW_{ab}.
\end{equation}
ここで$W_{ab}=W(\bex_a-\bex_b)$である。

\subsubsection{圧力項}
得られた密度から圧力を計算する。非圧縮性を満たすためにはPoisson方程式$\frac{\nabla^2p}{\rho}=\nabla\cdot(\vex\cdot\nabla\vex)+\nabla \cdot \bm{f}$を解かなければならないが、計算コストが大きい。そのため本計算ではTait方程式と呼ばれる状態方程式を用いて圧力を導出する。

Tait方程式は次のように表される、
\begin{equation}
  \label{eqn:Tait}
  P=B\left(
 \left(\frac{\rho}{\rho_0}\right)^\gamma-1
    \right).
\end{equation}
本計算では$\gamma=7$である。
係数Bは密度の変化幅に関係する係数であり、数値計算における音速と関連付けられる。音速は
\begin{equation}
C_s=\sqrt{\frac{\partial p}{\partial \rho}}
\end{equation}
で与えられるため、圧力が式(\ref{eqn:Tait})で与えられるとき
\begin{equation}
C_s^2=\frac{\partial p}{\partial \rho}=\frac{B\gamma}{\rho_0}\left(\frac{\rho}{\rho_0}\right)^{\gamma -1}
\end{equation}
となる。密度$\rho_0$の時の音速を$C_{s0}$と表すと
\begin{equation}
B=\frac{\rho_0C_{s0}^2}{\gamma}
\end{equation}
となり、式(\ref{eqn:Tait})は
\begin{equation}
P=\frac{\rho_0C_{s0}^2}{\gamma}\left(\left(\frac{\rho}{\rho_0}\right)^\gamma-1\right)
\end{equation}
となる。
式(\ref{eqn:Tait})で得られた圧力を用いて、粒子に与えられる加速度は次のように与えられる、
\begin{equation}
  \label{eqn:pressure_Ante}
\frac{d\vex_a}{dt}=-\frac{1}{\rho_a}\sum_bm_b\frac{P_a}{\rho_b}\nabla_aW_{ab}.
\end{equation}
しかしこの式では、粒子bから粒子aに働く力の大きさと粒子aから粒子bに働く力の大きさが等しくない即ち
\begin{equation}
\frac{m_am_bP_b}{\rho_a\rho_b}\nabla_aW_{ab} \neq -\frac{m_am_bP_a}{\rho_a\rho_b}\nabla_bW_{ab}
\end{equation}
であるため、運動量が正しく保存されない。そこで次のように式を変形する。

\begin{equation}
\frac{\nabla P}{\rho}=\nabla \left(\frac{P}{\rho}\right)+\frac{P}{\rho^2}\nabla \rho
\end{equation}
であることを用いると、式(\ref{eqn:pressure_Ante})は
\begin{equation}
\frac{d\vex_a}{dt}=-\sum_bm_b\left(\frac{P_a}{\rho_a^2}+\frac{P_b}{\rho_b^2}\right)\nabla_aW_{ab}
\end{equation}
と書くことができる。$|\bm{r}_a-\bm{r}_b|$のスカラー関数$F_{ab}$を用いて$\nabla_aW_{ab}=\bm{r}_{ab}F_{ab}$と書くと、粒子bから粒子aに働く力は
\begin{equation}
m_am_b\left(\frac{P_b}{\rho_b^2}+\frac{P_a}{\rho_a^2}\right)\bm{r}_{ab}F_{ab}
\end{equation}
と表すことができる。この式より粒子bから粒子aに働く力と粒子aから粒子bに働く力は、向きが反対で大きさが同じであることが分かる。以上の議論は\cite{Monaghan2005}に依る。

\subsubsection{人工粘性項}
計算の安定性向上および衝撃波の取り扱いのために人工粘性を導入する。

粘性項を粒子間の相対運動から導出するために、$\nabla_jW_{ij}$にかかる$\frac{p_i}{\rho_i^2}+\frac{p_j}{\rho_j^2}$の部分に新しく$\Pi_ij$という項を追加する。線形な形の、人工粘性の圧力は
\begin{equation}
q=-\alpha\rho hc\nabla\cdot v
\end{equation}
で与えられるため、$\pi_{ij}$は
\begin{equation}
  -\alpha \frac{hc}{\rho}\frac{\partial v}{\partial x}
\end{equation}
と近似することができる。ここで、
\begin{equation}
  \frac{v_{ij}}{x_{ji}}=\frac{v_i-v_j}{x_{ij}}=\frac{1}{x_{ij}}\left[ v_i-\left( v_i+x_{ji}\frac{\partial v_i}{\partial x_i} \right) \right] \sim \frac{\partial v_i}{\partial x_i}
\end{equation}
であるため、
\begin{equation}
\Pi_{ij}=-\alpha \frac{hc_i}{\rho_i}\frac{v_{ij}}{x_{ij}}
\end{equation}
となる。
粘性による加速度はMonaghanによる次の形式 \cite{Monaghan2005}を用いた、
\begin{equation}
\frac{d\vex_a}{dt}=\begin{cases}
  -\sum_bm_b\Pi_{ab}\nabla_aW_{ab} & \vex_{ab}\cdot\bex_{ab}<0, \\
  0 & \vex_{ab}\cdot\bex_{ab}\geq0.
\end{cases}
\end{equation}
ここで$\Pi_{ab}$は以下のように与えられる、
\begin{equation}
\Pi_{ab}=-\nu\left(\frac{\vex_{ab}\cdot\bex_{ab}}{|\bex_{ab}|^2+\epsilon h^2}\right).
\end{equation}
$\nu$は人工粘性を制御する係数であり、$\nu=\frac{2\alpha h c_s}{\rho_a+\rho_b}$で決定される。

\subsection{表面張力、親水性および疎水性の表現}
表面張力および親水性、疎水性の表現にはYangらの手法 \cite{Yang2016},\cite{Yang2017}を用いた。この手法は粒子の間に力を作用させることで、表面張力や個体表面での性質を再現する。粒子$i$に加えられる力は、
\begin{equation}
F^{\rm{int}}_i=\sum_{j} \bm{f}_{ji},
\end{equation}
\begin{equation}
  \bm{f}_{ji}=\begin{cases}
    c_{ij}m_im_j\cos\left(\frac{3\pi}{2kh}r_{ij}\right)\frac{\bm{r}_{ij}}{r_{ij}} & \text{$|\bm{r}_{ij}|\leq kh,$}\\
    0 & \text{$|\bm{r}_{ij}|\geq kh.$}
\end{cases}
\end{equation}
ここで$\bm{r}_{ij}=\bm{r}_i-\bm{r}_{j}$、$r_{ij}=|\bm{r}_{ij}|$である。$k$はenlargement ratioと呼ばれるパラメータであり、相互作用の力が働く粒子の距離を調節している。

$c_{ij}$は２粒子間の相互作用の強さであり、各粒子がどの相に属しているかによって値は変化する。それらの値は次の関係を満たす。
\begin{equation}
\cos\theta=\frac{c_{\alpha\alpha}-c_{\beta\beta}+2c_{\omega\alpha}-2c_{\omega\beta}}{c_{\alpha\alpha} +c_{\beta\beta} -2c_{\alpha\beta}.}
\end{equation}
ここで$\theta$は流体と床の接触角であり、$\alpha,\beta,\omega$はそれぞれ流体、空気、床に粒子が存在していることを意味している。

今、$c_{\alpha\beta},c_{\omega\beta}$は小さいことが物理的な観測より分かっているため0とする。また$c_{\alpha\alpha}=c_{\beta\beta}$としてもよいため
\begin{equation}
\cos\theta\simeq c_{\omega\alpha}/c_{\alpha\alpha}
\end{equation}
となる。
\begin{table}[h]
  \caption{相互作用の計算に用いられるパラメータ}
  \label{interParam}
  \begin{center}
    \begin{tabular}{|c|c|}\hline
      $k$&3.0 \\ \hline
      $c_{\alpha\alpha}$ & 60.0 \\ \hline
    \end{tabular}
  \end{center}  
\end{table}

\subsection{壁粒子の表現}
壁となる領域に座標を固定した粒子を配置する方法を採用した。壁粒子が一列である場合、壁近傍での圧力が低下し流体粒子が壁を通り抜けることがある。この現象を防ぐため、3層にわたって壁粒子を配置した。
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\columnwidth]{wallBoundary.png}
  \caption{壁粒子の様子}
  \label{fig:wallParticles} 
\end{figure}



\subsection{剛体の表現}
剛体の表現はPMS(Passively Moving Solid)法\cite{Gotoh2018}と呼ばれるモデルを用いた。
剛体は複数の剛体粒子が集まったものとして表現される。各タイムステップごとに剛体粒子を流体粒子と同様に計算し、速度を導出する。次に得られた速度を用いて以下の量を計算する。
\begin{equation}
  \bm{r}_g=\sum_{i}^n{\bm{r}_i}
\end{equation}
\begin{equation}
  \bm{q}_i=\bm{r}_i-\bm{r}_g
\end{equation}
\begin{equation}
  I=\sum_{i}^n{|\bm{q}_i|^2}
\end{equation}
ここで$\bm{r}_g,\bm{q}_i,I$はそれぞれ重心座標、重心から剛体粒子iへのベクトル、慣性モーメントであり、nは剛体粒子の個数である。これらの値を用いて剛体の並進速度$\bm{T}$および角速度$\bm{R}$を求める。
\begin{equation}
  \bm{T}=\frac{1}{n}\sum_{i}^n{\bm{v}_i}
\end{equation}
\begin{equation}
  \bm{R}=\frac{1}{I}\sum_{i}^n{\bm{v}_i\times\bm{q}_i}
\end{equation}
これらの値から剛体の速度は
\begin{equation}
\bm{v}_i=\bm{T}+\bm{q}_i\times\bm{R}
\end{equation}
となる。ここで新しく得られた速度を用いて剛体粒子の座標を更新する。

\subsection{近傍粒子の探索法}
粒子法では、ある粒子はその影響範囲内に存在する他の粒子とのみ相互作用を計算すればよい。影響範囲内に存在するか否かを判定する最も単純な方法は、2つの粒子間の距離を計算することであるが、全ての粒子に対して距離の計算を行うと
計算コストが大きくなる。本計算では、バケット構造を用いてある粒子の近傍にある粒子とのみ相互作用の計算をするようにしている。\cite{Koshiduka2014}ここで格子は粒子の位置の判別に用いられるのであって、Euler法のように格子自体が物理量を持っているわけではない。
　
計算領域全体に正方形のバケットを敷き詰め、それぞれのバケットは次のような番号を持っている
\begin{equation}
ib=ix+iy*nBx
\end{equation}
ここでibはバケットに付与された数、nBxはx軸方向に並べられたバケットの数であり、ix,iyはそれぞれバケットのx,y座標であり、次のようにして求められる。
\begin{equation}
ix=\lfloor(r_x-\rm{MIN\_X})/DB \rfloor
\end{equation}
\begin{equation}
iy=\lfloor(r_y-\rm{MIN\_Y})/DB \rfloor
\end{equation}
ここで$r_x,r_y$は粒子のxおよびy座標、DBはバケット一辺の長さであり、MIN\_X,MIN\_Yは計算範囲におけるxおよびyの最小値である。

近傍粒子の探索は以下のようにして行う……。


\subsection{時間発展}
本計算の時間発展にはleap-frog法を用いた。leap-frog法では時刻$i$にて次のように速度および位置を更新する。
\begin{equation}
  \vex^{i+\frac{1}{2}}=\vex^{i-\frac{1}{2}}+\bm{a}^idt,
\end{equation}
\begin{equation}
  \bex^{i+1}=\bex^i+\vex^{i+\frac{1}{2}}dt,
\end{equation}
\begin{equation}
  \vex^{i+1}=\vex^{i+\frac{1}{2}}+\frac{\bm{a}^i}{2}dt.
\end{equation}
時刻1において$\vex^{-\frac{1}{2}}$が存在しないため、次のようにして導出する。
\begin{equation}
  \vex^{\frac{1}{2}}=\vex^{0}+\frac{\bm{a}^0}{2}dt,
\end{equation}
\begin{equation}
  \bex^{1}=\bex^0+\vex^{\frac{1}{2}}dt,
\end{equation}
\begin{equation}
  \vex^{1}=\vex^{0}+\bm{a}^0dt.
\end{equation}

\subsection{単位系}
剛体球の直径Dと重力加速度gから、単位時間$T_g=\left(\frac{D}{g}\right)^{1/2}$を定義する。剛体球の初速に$T_g$を乗じたものをDで割ることによって、単位時間あたりに剛体球の直径の何倍移動するかという無次元量で剛体球の初速を定義する。この値を$U_0^*$と書き表す。

例として、実験での各値が、$D=2.0\times10^{-2}$[m],$v_0$=5[m/s]であるとき、$U_0^*\sim11.25$である。

粒子法での各値は$D=1, g=9.8$であるので、$U_0^*=11.25$を得るために、剛体球の初速は35.12でなければならない。

以上のようにして実験での値と数値計算での値を比較する。
\begin{table}[h]
  \caption{数値計算の初速と実験での初速の対応}
  \label{tab:velocity_non_dim}
  \begin{center}
    \begin{tabular}{|c|c|c|}\hline
      数値計算での初速&無次元化された初速&実験での初速 \\ \hline
      10.00 & 3.19 & 1.41 \\ \hline
      20.00 & 6.39 & 2.83 \\ \hline
      30.00 & 9.58 & 4.24 \\ \hline
      40.00 & 12.78 & 5.66 \\ \hline
      50.00 & 15.97 & 7.07 \\ \hline
      60.00 & 19.17 & 8.49 \\ \hline
      70.00 & 22.36 & 9.90 \\ \hline
      80.00 & 25.56 & 11.31 \\ \hline
    \end{tabular}
  \end{center}
\end{table}



\newpage
\section{計算結果}
\subsection{粘性、表面張力の測定}
粒子法における粘性・表面張力と、水が持つ粘性・表面張力を比較するために、次の数値計算を行った。
水面を波立たせた初期条件を与え、時間発展をさせる。その時に見られる波の波長を理論値と比べた。
まず重力波の比較を行う。重力波の分散関係は
\begin{equation}
  \omega(k)=\sqrt{gk\rm{tanh}\it{kh}}
\end{equation}
で与えられる\cite{tatsumiKiso}。$g=9.8, k=\frac{2\pi}{\lambda}=\frac{2\pi}{6.0}, h=3.0$を代入すると$\omega\sim3.18$である。これより周期は$\frac{2\pi}{3.18}\sim1.98$となる。実験で得られた周期はおよそ2.0であるためまず水面波を大方再現しているものと考えられる。
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\columnwidth]{waveSurf_1226_1953_3.png}
  \caption{粒子の初期配置}
  \label{fig:waveSurfInit}
\end{figure}
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\columnwidth]{waveSurf_1226_1953_.png}
  \caption{$x$=12における波高の時間発展}
  \label{fig:waveSurfEvol}
\end{figure}


次に表面張力係数の比較を行う。表面張力を考慮した水面派の分散関係は
\begin{equation}
\omega=\sqrt{\left(g+\frac{\gamma}{\rho}k^2 \right)k\rm{tanh}(\it{kh})}
\end{equation}
で与えられる\cite{tatsumiKiso}。$\rho\sim1000, \omega\sim4.18$の値を用いて$\gamma$の値を求めると、6399.5を得た。

表面張力を流体の密度で割った値を比較する。約18℃の水の場合、この値はおよそ80であり、数値計算から得られた値はおよそ６となる。これより、水の物性値と数値計算の間にはひと桁のズレが存在している。


\subsection{親水性、疎水性の妥当性}


半円状の流体を床の上に配置し、流体の運動が平衡状態に達した時の様子を比較する。
\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\columnwidth]{Phobyhalf40_1116_1906_1.png}
  \caption{初期状態}
  \label{fig:contactInitial}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{subfigure}{0.8\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_1116_1906_1601.png}
    \caption{疎水性}
    \label{fig:PhobyDrop}
  \end{subfigure}
  \begin{subfigure}{0.8\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1118_1813_1601.png}
    \caption{親水性}
    \label{fig:PhileDrop}
  \end{subfigure}
  \caption{親水性および疎水性の床の上に放置された水滴}
  \label{fig:contactAngles}
\end{figure}

図\ref{fig:PhobyDrop}および\ref{fig:PhileDrop}は接触角として$\frac{3}{4}\pi, \frac{\pi}{4}$を与えた時の流体の振る舞いを、80000ステップ時点で出力したものである。流体との接触角が$\frac{\pi}{2}$より小さいを親水性といい、$\frac{\pi}{2}$よりも大きい物を疎水性という \cite{Law2014}。図を見ると接触角がそれぞれ$\frac{\pi}{2}$よりも大きいあるいは小さいことが観測されるため、本モデルは親水性および疎水性の振る舞いを定性的に再現していると考えられる。

次に接触角の設定を変えて数値計算を行った。
\begin{figure}[H]
  \centering
  \begin{subfigure}{0.3\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_0107_1622_1001.png}
    \caption{接触角$\frac{7}{12}\pi$}
    \label{fig:phoby_pi3}
  \end{subfigure}
  \begin{subfigure}{0.6\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_0107_1622_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phoby_pi3wl}
  \end{subfigure}

  \begin{subfigure}{0.3\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_1231_1646_1001.png}
    \caption{接触角$\frac{3}{4}\pi$}
    \label{fig:phoby_pi4}
  \end{subfigure}
  \begin{subfigure}{0.6\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_1231_1646_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phoby_pi4wl}
  \end{subfigure}

  \begin{subfigure}{0.3\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_0107_1611_1001.png}
    \caption{接触角$\frac{11}{12}\pi$}
    \label{fig:phoby_pi6}
  \end{subfigure}
  \begin{subfigure}{0.6\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Phobyhalf40_0107_1611_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phoby_pi6wl}
  \end{subfigure}

  \caption{接触角を変化させた疎水性の床上の水滴}
\end{figure}

\begin{figure}[H]
  \centering
  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1500_1001_.png}
    \caption{接触角$\frac{\pi}{6}$}
    \label{fig:phile_pi6}
  \end{subfigure}
  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1500_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phile_pi6wl}
  \end{subfigure}

  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1506_1001_.png}
    \caption{接触角$\frac{\pi}{4}$}
    \label{fig:phile_pi4}
  \end{subfigure}
  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1506_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phile_pi4wl}
  \end{subfigure}
  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1514_1001_.png}
    \caption{接触角$\frac{\pi}{3}$}
    \label{fig:phile_pi3}
  \end{subfigure}
  \begin{subfigure}{0.4\columnwidth}
    \centering
    \includegraphics[width=\columnwidth]{Philehalf40_1231_1514_1001_wl.png}
    \caption{補助線付き}
    \label{fig:phile_pi3wl}
  \end{subfigure}

  \caption{接触角を変化させた親水性の床上の水滴}
\end{figure}

接触角を測る手続きとして以下のような手順を用いる。

水滴の底面とみなせる直線を引く。外縁部かつ水滴の下半球に存在する粒子を底面の粒子と呼ぶことにする。
底面の粒子を、中心から右へと確認していき、初めて底面の直線よりy座標が高くなった底面の粒子の座標をP1とする。その粒子より右に数えて10番目に存在する底面の粒子の座標をP2とする。2点P1とP2の間に直線を引き、その傾きを接触角の大きさと呼ぶことにする。

入力した接触角と得られた接触角の対応関係は、てんでんばらばらであった。図を見る限り入力した接触角の大小と出力された接触角の大小には相関関係があるようにも見えるが、それらを定量的に評価できる手続きを作り出すことができなかった。

以下の数値計算においては、接触角$\frac{\pi}{4},\frac{3}{4}\pi$をそれぞれ浸水性・疎水性の代表的な値として用い、それらの接触角と対応する実験での振る舞いと比較を行った。


\newpage
\subsection{剛体球の水面への衝突}
表面が親水性および疎水性の剛体球を水面に衝突させる。初速を変化させて、水面の変形による気泡の取り込みが見られるか否かを調べる。実験の値はDuez\cite{Duez2007}らによるものを参照した。
\subsubsection{疎水性の剛体}
図\ref{fig:hydrophobic}は、初速を変化させて疎水性の剛体を水面に衝突させ、左右に分離した流体が再び合体する箇所をグラフに出力したものである。
\begin{figure}[H]
  \centering
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1221_1836_389_cropped.png}
  \caption{衝突速度10}
  \label{fig:vel10}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1221_2215_389_cropped.png}
  \caption{衝突速度20}
  \label{fig:vel20}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_0151_393_cropped.png}
  \caption{衝突速度30}
  \label{fig:vel30}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_0528_403_cropped.png}
  \caption{衝突速度40}
  \label{fig:vel40}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_0903_401_cropped.png}
  \caption{衝突速度50}
  \label{fig:vel50}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_1237_401_cropped.png}
  \caption{衝突速度60}
  \label{fig:vel60}
\end{subfigure}
\end{figure}
\clearpage
\begin{figure}
\ContinuedFloat
  \begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_1609_393_cropped.png}
  \caption{衝突速度70}
  \label{fig:vel70}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phobyball10_1222_1919_385_cropped.png}
  \caption{衝突速度80}
  \label{fig:vel80}
\end{subfigure}
\caption{初速を変化させて疎水性の剛体を水面に衝突させた際の気泡の生成}
\label{fig:hydrophobic}
\end{figure}
初速20の時点で、界面の変形による気泡の取り込みが確認できる。


\subsubsection{親水性の剛体}
図\ref{fig:hydrophilic}は、初速を変化させて親水性の剛体を水面に衝突させ、左右に分離した流体が再び合体する箇所をグラフに出力したものである。
\begin{figure}[H]
  \centering
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1219_2335_341_cropped.png}
  \caption{衝突速度10}
  \label{fig:philevel10}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_0312_351_cropped.png}
  \caption{衝突速度20}
  \label{fig:philevel20}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_0616_357_cropped.png}
  \caption{衝突速度30}
  \label{fig:philevel30}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_0950_347_cropped.png}
  \caption{衝突速度40}
  \label{fig:philevel40}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_1324_377_cropped.png}
  \caption{衝突速度50}
  \label{fig:philevel50}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_1701_377_cropped.png}
  \caption{衝突速度60}
  \label{fig:philevel60}
\end{subfigure}
\end{figure}
\clearpage
\begin{figure}
\ContinuedFloat
  \begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1220_2037_361_cropped.png}
  \caption{衝突速度70}
  \label{fig:philevel70}
\end{subfigure}
\begin{subfigure}{0.3\columnwidth}
  \centering
  \includegraphics[width=\columnwidth]{rec300Phileball10_1221_0008_361_cropped.png}
  \caption{衝突速度80}
  \label{fig:philevel80}
\end{subfigure}
\caption{初速を変化させて親水性の剛体を水面に衝突させた際の気泡の生成}
\label{fig:hydrophilic}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.8\columnwidth]{trajectory_x.png}
  \caption{重心x座標の時間発展}
  \label{fig:trajectory}
\end{figure}

左右に大きくずれているのは何故か。非圧縮性の問題は？云々……
\newpage

\section{議論}

キャビティが見えたか見えなかったかの議論。

親水性の剛体球で見られた左右の位置の変動。

その他諸々を議論する予定。
\newpage
\section{結論}
\subsection{まとめ}
Duez\cite{Duez2007}での結果を再現できたか否かに対してYes/Noの結論を書いた後、その根拠を書き記す予定。
\subsection{今後の展望}
左右の壁の位置が近すぎたのでは？Yang\cite{Yang2017}にある改良された接触角のモデルではどうか？
SPHの誤差を修正するモデルを加えてはどうか？そのモデルの物理的な妥当性は議論が必要で云々……など今回試していない事柄について書き記す予定。
\newpage

\section{謝辞}
感謝の意を表す予定。
\newpage

\bibliography{thesis}
\bibliographystyle{junsrt}

\end{document}
